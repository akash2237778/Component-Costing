<tr class="hover:bg-gray-50 transition slide-in item-row">
    
    <td class="p-2 font-medium text-gray-700 border-r shadow-sm bg-blue-50">
        <input type="text" value="{{ .Component.Name }}" class="row-name w-full bg-transparent border-b border-blue-200 focus:outline-none focus:border-blue-500 font-bold text-blue-900"
               oninput="saveDraft()">
        <form id="row-form-{{ .Component.ID }}">
            <input type="hidden" name="component_id" value="{{ .Component.ID }}">
            <input type="hidden" name="shape" value="{{ .Component.Shape }}">
        </form>
    </td>
    
    {{ if eq .Component.Shape "Fixed" }}
        <td colspan="4" class="p-1 border-r bg-gray-50 text-center text-gray-400 text-xs italic">Standard Item</td>
        
        <td colspan="3" class="p-1 border-r bg-white">
            <input type="number" step="1" name="manual_price" placeholder="Unit Price ₹" value="{{ if .Component.ManualPrice }}{{ .Component.ManualPrice }}{{ end }}" form="row-form-{{ .Component.ID }}" 
                   class="row-manual-price w-full border-2 border-blue-200 rounded p-1 text-center font-bold text-blue-800"
                   oninput="saveDraft()"
                   hx-post="/calculate" hx-trigger="keyup delay:400ms changed" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}">
        </td>
        <td class="bg-gray-50"></td> <td class="bg-gray-50"></td> <td class="bg-gray-50"></td> <td class="bg-gray-50 border-r"></td>

    {{ else }}
        <td class="p-1 border-r">
            <select name="material_id" form="row-form-{{ .Component.ID }}" class="row-material w-full border rounded p-1 text-xs bg-white"
                    onchange="saveDraft()"
                    hx-post="/calculate" hx-trigger="change" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}">
                <option value="0">Select...</option>
                {{ $currMat := .Component.MaterialID }}
                {{ range .Materials }}
                    <option value="{{ .ID }}" {{ if eq .ID $currMat }}selected{{ end }}>{{ .Name }}</option>
                {{ end }}
            </select>
        </td>

        <td class="p-1"><input type="number" name="length" placeholder="L" value="{{ if .Component.Length }}{{ .Component.Length }}{{ end }}" class="row-length w-full border rounded p-1 text-center" oninput="saveDraft()" form="row-form-{{ .Component.ID }}" hx-post="/calculate" hx-trigger="keyup delay:400ms changed" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}"></td>
        <td class="p-1"><input type="number" name="width" placeholder="W" value="{{ if .Component.Width }}{{ .Component.Width }}{{ end }}" class="row-width w-full border rounded p-1 text-center" oninput="saveDraft()" form="row-form-{{ .Component.ID }}" hx-post="/calculate" hx-trigger="keyup delay:400ms changed" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}"></td>
        <td class="p-1 border-r"><input type="number" name="height" placeholder="H" value="{{ if .Component.Height }}{{ .Component.Height }}{{ end }}" class="row-height w-full border rounded p-1 text-center" oninput="saveDraft()" form="row-form-{{ .Component.ID }}" hx-post="/calculate" hx-trigger="keyup delay:400ms changed" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}"></td>

        <td class="p-2 text-center text-gray-500 bg-gray-50 font-mono text-xs border-r">
            <div id="weight-div-{{ .Component.ID }}">-</div>
        </td>
        <td class="p-2 text-center text-gray-500 bg-gray-50 font-mono text-xs border-r">
            <div id="area-div-{{ .Component.ID }}">-</div>
        </td>
        
        <td class="p-2 text-center bg-orange-50 border-r align-middle">
            <div class="flex flex-col items-center">
                <input type="checkbox" name="include_squaring" value="true" {{ if .Component.IncludeSquaring }}checked{{ end }} 
                       onchange="saveDraft()" form="row-form-{{ .Component.ID }}" 
                       hx-post="/calculate" hx-trigger="change" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}">
                <div id="pre-mach-div-{{ .Component.ID }}" class="text-xs font-bold text-orange-800">-</div>
            </div>
        </td>

        <td class="p-2 text-center bg-red-50 border-r align-middle">
            <div class="flex flex-col items-center">
                <input type="checkbox" name="include_ht" value="true" {{ if .Component.IncludeHT }}checked{{ end }} 
                       onchange="saveDraft()" form="row-form-{{ .Component.ID }}" 
                       hx-post="/calculate" hx-trigger="change" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}">
                <div id="ht-div-{{ .Component.ID }}" class="text-xs font-bold text-red-800">-</div>
            </div>
        </td>

        <td class="p-1 bg-white">
            <input type="number" name="cnc_hours" placeholder="Hrs" class="w-full border rounded p-1 text-center" oninput="saveDraft()" form="row-form-{{ .Component.ID }}" hx-post="/calculate" hx-trigger="keyup delay:400ms changed" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}">
            <div id="cnc-cost-div-{{ .Component.ID }}" class="text-xs text-center text-gray-400">-</div>
        </td>
        <td class="p-1 bg-white">
            <input type="number" name="wirecut_len" placeholder="mm" class="w-full border rounded p-1 text-center" oninput="saveDraft()" form="row-form-{{ .Component.ID }}" hx-post="/calculate" hx-trigger="keyup delay:400ms changed" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}">
            <div id="wire-cost-div-{{ .Component.ID }}" class="text-xs text-center text-gray-400">-</div>
        </td>
        <td class="p-1 border-r bg-white">
            <input type="number" name="drilling_cost" placeholder="₹" class="w-full border rounded p-1 text-center" oninput="saveDraft()" form="row-form-{{ .Component.ID }}" hx-post="/calculate" hx-trigger="keyup delay:400ms changed" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}">
        </td>
    {{ end }}

    <td class="p-1 border-r bg-white">
        <input type="number" name="quantity" value="{{ if .Component.Quantity }}{{ .Component.Quantity }}{{ else }}1{{ end }}" 
               class="row-qty w-full border rounded p-1 text-center font-bold text-blue-600" 
               oninput="saveDraft()" 
               form="row-form-{{ .Component.ID }}" 
               hx-post="/calculate" hx-trigger="change, input delay:300ms" hx-include="#row-form-{{ .Component.ID }}" hx-target="#cost-val-{{ .Component.ID }}">
    </td>

    <td class="p-2 text-right font-bold text-green-700 bg-green-50 shadow-inner flex flex-col justify-between h-full min-h-[60px]">
        <span id="cost-val-{{ .Component.ID }}" class="row-total block mb-1">
            {{ if .Component.RowCost }}₹{{ printf "%.2f" .Component.RowCost }}{{ else }}₹0.00{{ end }}
        </span>
        <button hx-delete="/component/remove" hx-target="closest tr" hx-swap="outerHTML" 
                class="text-[10px] text-red-400 hover:text-red-600 uppercase tracking-wider font-semibold self-end">
            Remove ✕
        </button>
    </td>
</tr>